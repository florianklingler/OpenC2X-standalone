<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>ITSProtocolStack: Documentation</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ITSProtocolStack
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('index.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Documentation </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="Overview"></a>
Overview</h1>
<p>The ITS Protocol Stack implementation includes Decentralized Congestion Control (<a class="el" href="classDCC.html" title="Decentralized Congestion Control. ">DCC</a>), services like Cooperative Awareness Service (<a class="el" href="classCaService.html" title="Class that handles the receiving, creating and sending of CA Messages. ">CaService</a>), Decentralized Environmental Notification Service (<a class="el" href="classDenService.html" title="Class that handles the receiving, creating and sending of DEN Messages. ">DenService</a>), modifications in the transmission path in the Linux kernel 3.18 and a web interface to view the current position and monitor the incoming or outgoing CAMs, DENMs and <a class="el" href="classDCC.html" title="Decentralized Congestion Control. ">DCC</a> states.</p>
<h1><a class="anchor" id="high_level_arch"></a>
High level architecture</h1>
<div class="image">
<img src="../res/architecture.png"  alt="High Level Architecture Diagram" title="High Level Architecture Diagram"/>
</div>
<p> There are two kinds of messages that can be sent and received: CAMs and DENMs which are generated by the <a class="el" href="classCaService.html" title="Class that handles the receiving, creating and sending of CA Messages. ">CaService</a> and <a class="el" href="classDenService.html" title="Class that handles the receiving, creating and sending of DEN Messages. ">DenService</a>, respectively. Both include the GPS and OBD2 data which they periodically receive from the sensors. CAMs are triggered periodically and DENMs can be triggered manually via the web interface. When a message is generated it is sent both to <a class="el" href="classDCC.html" title="Decentralized Congestion Control. ">DCC</a> and <a class="el" href="classLDM.html" title="The Local Dynamic Map (LDM) is responsible for maintaining data that is part of ITS. ">LDM</a>. <a class="el" href="classDCC.html" title="Decentralized Congestion Control. ">DCC</a> handles the message and finally hands it over to the Ath9k WiFi Card to send it over the wireless channel. <a class="el" href="classLDM.html" title="The Local Dynamic Map (LDM) is responsible for maintaining data that is part of ITS. ">LDM</a> stores incoming messages in a database and provides the information to the server and the web interface. For more information on the modules, see <a href="modules.html">Modules</a>.</p>
<h1><a class="anchor" id="compile_sec"></a>
Compiling the source</h1>
<p>To fulfill the package dependencies, run the following command in the terminal. </p><pre class="fragment">sudo apt-get install libzmq3-dev libboost-all-dev protobuf-compiler libprotobuf-dev libgps-dev gpsd gpsd-clients libnl-3-200 libnl-3-dev libnl-genl-3-200 libnl-genl-3-dev sqlite3 libsqlite3-dev tmux </pre><p>To compile, run the script (from within the scripts folder). </p><pre class="fragment">./compileAll.sh </pre><p> All code was written to be compiled and run on Debian Jessie 8 i386 (currently on apu, alix, and gericom). If you want to compile on a different system, you need to comment out line no. 4 in the script. Modified Linux kernel 3.18 can be found on: </p><pre class="fragment">git@git.ccs-labs.org:ath9k-ocb-kernel, branch: gurjashan.pannu/pg2015w and hash: 4ef14d9fde435824af5e736bed3dfe9f9193bf65 </pre><h1><a class="anchor" id="config_sec"></a>
Setting configuration</h1>
<p>There are 2 types of config files in the system. </p><ul>
<li><a class="el" href="structGlobalConfig.html" title="Struct that hold the global configuration. ">GlobalConfig</a>: It contains the system related configuration like experiment number, interface name etc. It can be found in ''common/config/config.xml'' </li>
<li>Config: Most modules also have their own configuration e.g. <a class="el" href="structCaServiceConfig.html" title="Struct that hold the configuration for CaService. ">CaServiceConfig</a> in <a class="el" href="classCaService.html" title="Class that handles the receiving, creating and sending of CA Messages. ">CaService</a>, which can be found in ''&lt;module&gt;/config/config.xml''</li>
</ul>
<h2><a class="anchor" id="log_subsec"></a>
Logging Outputs</h2>
<p>INFO, DEBUG and ERROR logging levels have been used in the software. The logging configs can also be set in logging.conf and statistics.conf in every ''&lt;module&gt;/config/''.</p>
<h1><a class="anchor" id="run_sec"></a>
Execution</h1>
<p>Before starting all configs should be checked. Especially the <a class="el" href="structGlobalConfig.html" title="Struct that hold the global configuration. ">GlobalConfig</a> in common and the ones for GPS and OBD2 should be configured to use the correct devices. GPS device might need to be configured to ttyACM0 in /etc/default/gpsd to use GPSd (e.g. for apu).<br />
After compiling the executable for each module can be found at &lt;module&gt;/Debug/ and executed by hand. But there are also scripts to automate the starting process. Tmux need to be installed for these scripts. The application can be run locally by the script. </p><pre class="fragment">./runAllLocal.sh </pre><p> To stop the execution run on the local machine </p><pre class="fragment">tmux kill-session </pre><p> There are two ways to run the Application on a remote like an alix box. But first the compiled repo needs to be copied to the remote home dir. Then following actions are possible.</p>
<h2><a class="anchor" id="run_sec_1"></a>
the brittle but comfortable way</h2>
<p>The most comfortable way to start and setup everything is to simply run </p><pre class="fragment">./runAllSSH.sh ssh-configuration-name</pre><p> Replace "ssh-configuration-name" with the name of the remote target in the local ssh configuration eg. "alix6". Preferably the keys are already copied to the target so password-less ssh connections are possible. This script executes the setup script on the remote and opens on the local machine a tmux session. This session is split in multiple planes and in each plane a separate ssh session is opened. Then in each ssh session one module is executed. Afterwards in a separate panel a ssh port forwarding tunnel is opened (for the monitoring interface) and on the local machine the monitoring webpage is opened. To stop the execution run on the local machine </p><pre class="fragment">tmux kill-session </pre><p> The problem with this method is that if the ssh connection is lost the execution of the application is aborted and everything needs to be restarted.</p>
<h2><a class="anchor" id="run_sec_2"></a>
the robust but tedious way</h2>
<p>A more robust alternative starts with opening a ssh connection to the remote. There execute the </p><pre class="fragment">setup_interfaces.sh </pre><p> afterwards run </p><pre class="fragment">runAllLocal.sh </pre><p> on the remote. Back in a new terminal on the local machine run </p><pre class="fragment">sshTunnel.sh ssh-configuration-name </pre><p> (Replace "ssh-configuration-name" with the name of the remote target in the local ssh configuration eg. "alix6".)<br />
and open the Monitor website at </p><pre class="fragment">webSite/index.html </pre><p> to stop the execution run on the remote machine </p><pre class="fragment">tmux kill-session </pre><p> If the ssh connection is lost simply restart the ssh tunnel and run on the remote machine </p><pre class="fragment">tmux attach </pre><h2><a class="anchor" id="run_sec_3"></a>
(manual execution)</h2>
<p>It's also possible to start all modules by hand. The executables may be found at </p><pre class="fragment">&lt;module_dir&gt;/Debug/&lt;module&gt; </pre> <dl class="highlight"><dt><b><a class="el" href="highlight.html#_highlight000001">Feature Highlight:</a></b></dt><dd><p class="startdd">The startup order of the modules may be arbitrarily chosen. </p>
<p class="enddd">Ruining modules may be stopped at will and restarted without further disruptions.</p>
</dd></dl>
<h1><a class="anchor" id="gui_sec"></a>
Web Interface</h1>
<p>See <a class="el" href="websiteTutorial.html">Website Tutorial</a></p>
<h1><a class="anchor" id="highlights_sec"></a>
Feature Highlights</h1>
<p>For a list of feature Highlights see <a class="el" href="highlight.html">Feature Highlights List</a> </p>
<h1><a class="anchor" id="standard_sec"></a>
Standard Conformity</h1>
<p>Everything we know of which is not conform to the ETSI ITS standard and influences the external behavior of the Application is listed in <a class="el" href="nonStandard.html">Not conform to ETSI ITS standard list</a></p>
<h1><a class="anchor" id="eclipse"></a>
Eclipse Integration</h1>
<p>Every folder in the Repository is an working Eclipse Project. <br />
Used Plugins:</p><ul>
<li>Base: Eclipse Mars 4.5.1 CDT</li>
<li>Doxygen editor: eclox (not up to date but still working)</li>
<li>Javascript editor:<ul>
<li>"web dev tools" and "js dev tools" from the eclipse repositories (Help -&gt; Install new Software)</li>
<li>"tern" from eclipse marketplace (Help -&gt; Eclipse Marketplace)</li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="ports"></a>
Port Diagramm</h1>
<p>Diagram of ports used by zmq and http between the modules </p><div class="image">
<img src="../res/portDiagram.png"  alt="Diagram of used Ports" title="Diagram of used Ports"/>
</div>
<h1><a class="anchor" id="license_sec"></a>
Licenses</h1>
<p>Brief license information of used software. </p><table class="doxtable">
<tr>
<th>Software </th><th>License information  </th></tr>
<tr>
<td>ZMQ </td><td>LGPLv3 with a static linking exception including for iPhone apps </td></tr>
<tr>
<td>Boost </td><td>Include copyright notice <a href="http://www.boost.org/users/license.html">http://www.boost.org/users/license.html</a> </td></tr>
<tr>
<td>Protobuffer </td><td>Include copyright notice <a href="https://github.com/google/protobuf/blob/master/LICENSE">https://github.com/google/protobuf/blob/master/LICENSE</a> </td></tr>
<tr>
<td>GPSd </td><td>Most of GPSD is under the permissive BSD license. Some portions are under other permissive licenses, including the MIT/X license and the ISC license. </td></tr>
<tr>
<td>Netlink </td><td>LGPL: <a href="https://github.com/tgraf/libnl/blob/master/COPYING">https://github.com/tgraf/libnl/blob/master/COPYING</a> </td></tr>
<tr>
<td>SQLite </td><td>Public domain: <a href="https://www.sqlite.org/copyright.html">https://www.sqlite.org/copyright.html</a> </td></tr>
<tr>
<td>Easylogging++</td><td>MIT license, include copyright notice: <a href="https://github.com/easylogging/easyloggingpp#licence">https://github.com/easylogging/easyloggingpp#licence</a> </td></tr>
<tr>
<td>Pbjson </td><td>Include copyright notice: <a href="https://github.com/yinqiwen/pbjson/blob/master/LICENSE">https://github.com/yinqiwen/pbjson/blob/master/LICENSE</a> </td></tr>
<tr>
<td>Crow </td><td>Include copyright notice: <a href="https://github.com/ipkn/crow/blob/master/LICENSE">https://github.com/ipkn/crow/blob/master/LICENSE</a> </td></tr>
<tr>
<td>jQuery </td><td>jQuery Foundation projects are released under the terms of the license specified in the project's repository or if not specified, under the MIT license. </td></tr>
<tr>
<td>Leaflet </td><td>Include copyright notice: <a href="https://github.com/Leaflet/Leaflet/blob/master/LICENSE">https://github.com/Leaflet/Leaflet/blob/master/LICENSE</a> </td></tr>
<tr>
<td>OpenStreetMap</td><td>OpenStreetMapÂ® is open data, licensed under the Open Data Commons Open Database License (ODbL) by the OpenStreetMap Foundation (OSMF). </td></tr>
</table>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
